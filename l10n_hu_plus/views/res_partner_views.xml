<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Form view inherit -->
    <record id="view_partner_form_inherit"
            model="ir.ui.view"
    >
        <field name="name">l10n.hu.plus.view.partner.form.inherit</field>
        <field name="inherit_id"
               ref="base.view_partner_form"
        />
        <field name="model">res.partner</field>
        <field name="priority">36</field>
        <field name="arch"
               type="xml"
        >
            <!-- Fields -->
            <xpath expr="//page[@name='internal_notes']"
                   position="after"
            >
                <page name="l10n_hu_plus"
                      invisible="not l10n_hu_plus_visible"
                      string="HU+"
                >
                    <field name="l10n_hu_plus_visible"
                           invisible="1"
                    />
                    <group name="l10n_hu_plus_hidden"
                           colspan="2"
                           invisible="not parent_id"
                    >
                        <div name="l10n_hu_plus_hidden"
                             class="card bg-info mr-4"
                             colspan="2"
                        >
                            <div class="card-header">
                                <i class="fa fa-info-circle mr-2"/>
                                <span class="mr-2">Settings are managed on the parent partner</span>
                                <button name="open_commercial_entity"
                                        class="btn btn-sm btn-primary"
                                        string="Open Parent"
                                        type="object"
                                />
                            </div>
                        </div>
                    </group>
                    <group name="l10n_hu_plus_displayed"
                           invisible="parent_id"
                    >
                        <group name="l10n_hu_plus_1">
                            <field name="l10n_hu_trade_position"
                                   groups="account.group_account_invoice"
                                   invisible="not property_account_position_id"
                                   string="Trade Position"
                            />
                            <field name="l10n_hu_vat_status"
                                   string="VAT Status"
                            />
                            <field name="l10n_hu_incorporation"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="Taxpayer Type"
                            />
                            <field name="l10n_hu_crn"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                            />
                            <field name="l10n_hu_vpid"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="VPID"
                            />
                            <field name="l10n_hu_financial_representative"
                                   invisible="l10n_hu_incorporation != 'self_employed'"
                                   options="{'no_quick_create': True,}"
                            />
                            <field name="l10n_hu_self_employed_number"
                                   help="Self-Employed Number"
                                   invisible="l10n_hu_incorporation != 'self_employed'"
                                   readonly="not is_company and parent_id"
                                   string="S.E. Number"
                            />
                            <field name="l10n_hu_self_employed_name"
                                   help="Self-Employed Name"
                                   invisible="l10n_hu_incorporation != 'self_employed'"
                                   readonly="not is_company and parent_id"
                                   string="S.E. Name"
                            />
                        </group>
                        <group name="l10n_hu_plus_2">
                            <label name="l10n_hu_plus_actions"
                                   for="action_l10n_hu_plus_set_vat_status"
                                   string="Actions"
                            />
                            <div name="l10n_hu_plus_actions">
                                <button name="action_l10n_hu_plus_set_vat_status"
                                        class="btn btn-link"
                                        icon="fa-refresh"
                                        string="Refresh VAT status"
                                        type="object"
                                />
                            </div>
                            <field name="l10n_hu_cash_accounting"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="Cash Accounting"
                                   widget="boolean_toggle"
                            />
                            <field name="l10n_hu_personal_tax_exempt"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="Personal Tax Exempt"
                                   widget="boolean_toggle"
                            />
                            <field name="l10n_hu_self_billing"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="Self Billing"
                                   widget="boolean_toggle"
                            />
                            <field name="l10n_hu_small_business"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="Small Business"
                                   widget="boolean_toggle"
                            />
                            <field name="l10n_hu_vat_reverse_charge"
                                   invisible="l10n_hu_vat_status != 'domestic'"
                                   string="VAT Reverse Charge"
                                   widget="boolean_toggle"
                            />
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
    <!-- List view inherit -->
    <record id="view_partner_tree_inherit"
            model="ir.ui.view"
    >
        <field name="name">l10n.hu.base.view.partner.tree.inherit</field>
        <field name="inherit_id"
               ref="base.view_partner_tree"
        />
        <field name="model">res.partner</field>
        <field name="priority">36</field>
        <field name="arch"
               type="xml"
        >
            <!-- Add partner fields -->
            <xpath expr="//field[@name='vat']"
                   position="after"
            >
                <field name="l10n_hu_vpid"
                       optional="hide"
                       string="VPID"
                />
            </xpath>
        </field>
    </record>
    <!-- Search view inherit -->
    <record id="view_res_partner_filter_inherit"
            model="ir.ui.view"
    >
        <field name="name">l10n.hu.base.view.res.partner.filter.inherit</field>
        <field name="inherit_id"
               ref="base.view_res_partner_filter"
        />
        <field name="model">res.partner</field>
        <field name="priority">36</field>
        <field name="arch"
               type="xml"
        >
            <!-- Field -->
            <xpath expr="//field[@name='parent_id']"
                   position="after"
            >
                <field name="l10n_hu_vpid"
                       string="VPID"
                />
            </xpath>
        </field>
    </record>
</odoo>
