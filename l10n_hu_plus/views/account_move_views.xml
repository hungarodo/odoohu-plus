<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Form view inherit -->
    <record id="view_move_form_inherit"
            model="ir.ui.view"
    >
        <field name="name">l10n.hu.plus.view.move.form.inherit</field>
        <field name="inherit_id"
               ref="account.view_move_form"
        />
        <field name="model">account.move</field>
        <field name="priority">36</field>
        <field name="arch"
               type="xml"
        >
            <!-- HU+ fields -->
            <xpath expr="//page[@name='aml_tab']"
                   position="after"
            >
                <page name="l10n_hu_plus"
                      string="HU+"
                >
                    <group name="l10n_hu_plus">
                        <group name="l10n_hu_plus_1"
                               invisible="l10n_hu_journal_type not in ['purchase', 'sale']"
                        >
                            <!-- Payment -->
                            <field name="l10n_hu_invoice_payment_method"
                                   readonly="state != 'draft'"
                                   string="Payment Method"
                            />
                            <!-- Document type -->
                            <field name="l10n_hu_plus_document_type"
                                   options="{'no_create': True,}"
                                   readonly="state != 'draft'"
                            />
                            <!-- Currency -->
                            <label name="l10n_hu_document_rate"
                                   for="l10n_hu_document_rate"
                                   invisible="currency_id == company_currency_id"
                                   string="Document Rate"
                            />
                            <div name="l10_hu_document_rate"
                                 invisible="currency_id == company_currency_id"
                            >
                                <field name="l10n_hu_document_rate"
                                       class="oe_inline"
                                />
                                <button name="action_l10n_hu_wizard_currency_exchange"
                                        class="oe_inline btn-sm btn-link"
                                        icon="fa-calculator"
                                        string="Currency Exchange"
                                        type="object"
                                />
                            </div>
                            <label name="l10n_hu_accounting_rate"
                                   for="l10n_hu_currency_rate"
                                   invisible="currency_id == company_currency_id"
                                   string="Accounting Rate"
                            />
                            <div name="l10n_hu_accounting_rate"
                                 invisible="currency_id == company_currency_id"
                            >
                                <field name="l10n_hu_currency_rate"
                                       class="oe_inline"
                                />
                                <field name="l10n_hu_currency_name"
                                       class="oe_inline ps-2 pe-2"
                                />
                                <field name="l10n_hu_currency_date"
                                       class="oe_inline"
                                />
                            </div>
                            <field name="l10n_hu_rate_difference"
                                   invisible="currency_id == company_currency_id"
                                   string="Rate Difference"
                            />
                        </group>
                        <group name="l10n_hu_plus_2"
                               invisible="l10n_hu_journal_type not in ['purchase', 'sale']"
                        >
                            <!-- VAT -->
                            <field name="l10n_hu_vat_date"
                                   string="VAT Date"
                            />
                            <!-- Cash accounting -->
                            <field name="l10n_hu_cash_accounting"
                                   force_save="1"
                                   readonly="move_type in ['out_invoice', 'out_refund']"
                                   string="Cash Accounting"
                            />
                            <!-- Period -->
                            <label name="l10n_hu_invoice_delivery_period"
                                   for="l10n_hu_invoice_delivery_period_start"
                                   string="Delivery Period"
                            />
                            <div name="l10n_hu_invoice_delivery_period">
                                <field name="l10n_hu_invoice_delivery_period_start"
                                       class="oe_inline"
                                       placeholder="Period Start"
                                       readonly="state != 'draft'"
                                />
                                <span class="ps-2 pe-2">-</span>
                                <field name="l10n_hu_invoice_delivery_period_end"
                                       class="oe_inline"
                                       placeholder="Period End"
                                       readonly="state != 'draft'"
                                />
                                <field name="l10n_hu_invoice_delivery_period_summary"
                                       invisible="l10n_hu_journal_type != 'sale'"
                                />
                                <field name="l10n_hu_invoice_delivery_period_legal"
                                       invisible="l10n_hu_journal_type != 'sale'"
                                />
                                <button name="action_l10n_hu_refresh_invoice_delivery_period"
                                        class="oe_inline btn-sm btn-link"
                                        icon="fa-refresh"
                                        invisible="state != 'posted' or l10n_hu_journal_type != 'sale'"
                                        string="Refresh"
                                        type="object"
                                />
                            </div>
                            <!-- Original -->
                            <label name="l10n_hu_original_invoice"
                                   for="l10n_hu_original_invoice_number"
                                   string="Original Invoice Number"
                            />
                            <div name="l10n_hu_original_invoice">
                                <field name="l10n_hu_original_invoice_number"
                                       class="oe_inline"
                                />
                                <button name="action_l10n_hu_view_original_invoice"
                                        class="oe_inline btn-sm btn-link"
                                        icon="fa-folder-open"
                                        invisible="not l10n_hu_original_invoice_number"
                                        string="View"
                                        type="object"
                                />
                            </div>
                            <field name="l10n_hu_original_account_move"
                                   invisible="1"
                            />
                        </group>
                        <group name="l10n_hu_plus_3"
                               invisible="l10n_hu_journal_type not in ['purchase', 'sale']"
                               string="Partner"
                        >
                            <!-- Partner -->
                            <field name="l10n_hu_fiscal_representative"
                                   options="{'no_create': True,}"
                            />
                            <field name="l10n_hu_fiscal_representative_bank_account"
                                   domain="[('partner_id', '=', l10n_hu_fiscal_representative)]"
                                   options="{'no_create': True,}"
                            />
                            <field name="l10n_hu_company_partner"/>
                            <field name="l10n_hu_partner_country"/>

                        </group>
                        <group name="l10n_hu_plus_4"
                               string="Journal"
                        >
                            <field name="l10n_hu_journal_type"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
    <!-- List view inherit  -->
    <record id="view_invoice_tree_inherit"
            model="ir.ui.view"
    >
        <field name="name">l10n.hu.account.view.invoice.tree.inherit</field>
        <field name="inherit_id"
               ref="account.view_invoice_tree"
        />
        <field name="model">account.move</field>
        <field name="priority">36</field>
        <field name="arch"
               type="xml"
        >
            <!-- HU fields -->
            <xpath expr="//field[@name='date']"
                   position="before"
            >
                <field name="l10n_hu_partner_country"
                       optional="hide"
                />
                <field name="l10n_hu_trade_position"
                       optional="hide"
                       string="Trade Position"
                />
            </xpath>
            <!-- HU fields -->
            <xpath expr="//field[@name='date']"
                   position="after"
            >
                <field name="l10n_hu_vat_date"
                       optional="hide"
                       string="HU VAT Date"
                />
            </xpath>
        </field>
    </record>
    <!-- Search view inherit  -->
    <record id="view_account_invoice_filter_inherit"
            model="ir.ui.view"
    >
        <field name="name">l10n.hu.account.view.account.invoice.filter.inherit</field>
        <field name="inherit_id"
               ref="account.view_account_invoice_filter"
        />
        <field name="model">account.move</field>
        <field name="priority">36</field>
        <field name="arch"
               type="xml"
        >
           <!-- Filter -->
            <xpath expr="//filter[@name='due_date']"
                   position="after"
            >
                <separator/>
                <filter name="l10n_hu_vat_date_filter"
                        date="l10n_hu_vat_date"
                        string="HU VAT Date"
                />
                <separator/>
                <filter name="l10n_hu_trade_position_domestic_filter"
                        domain="[('l10n_hu_trade_position', '=', 'domestic')]"
                        string="Domestic"
                />
                <filter name="l10n_hu_trade_position_eu_filter"
                        domain="[('l10n_hu_trade_position', '=', 'eu')]"
                        string="EU"
                />
                <filter name="l10n_hu_trade_position_other_filter"
                        domain="[('l10n_hu_trade_position', '=', 'other')]"
                        string="Other"
                />
                <filter name="l10n_hu_trade_position_none_filter"
                        domain="[('l10n_hu_trade_position', '=', False)]"
                        string="No Trade Position"
                />
            </xpath>
            <!-- Filter group by -->
            <xpath expr="//filter[@name='group_by_sequence_prefix']"
                   position="after"
            >
                <separator/>
                <filter name="l10n_hu_vat_date_filter_group_by"
                        context="{'group_by': 'l10n_hu_vat_date'}"
                        string="HU VAT Date"
                />
                <filter name="l10n_hu_partner_country_filter_group_by"
                        context="{'group_by': 'l10n_hu_partner_country'}"
                        string="Partner Country"
                />
                <filter name="l10n_hu_trade_position_filter_group_by"
                        context="{'group_by': 'l10n_hu_trade_position'}"
                        string="Trade Position"
                />
                <filter name="partner_id_filter_group_by"
                        context="{'group_by': 'partner_id'}"
                        string="Partner"
                />
            </xpath>
        </field>
    </record>
</odoo>
